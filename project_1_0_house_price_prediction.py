# -*- coding: utf-8 -*-
"""Project 1.0 House Price Prediction

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1eR68fA5vzZhXmn1CWzO3uQOnIrlXWadR
"""

import pandas as pd
import numpy as  np
import seaborn as sns
from scipy import stats
import matplotlib.pyplot as plt

df=pd.read_csv('./House_Price.csv')

df.describe()

df['n_hos_beds']=df.n_hos_beds.fillna(df.n_hos_beds.mean())

df.corr()

sns.boxplot(x=df['crime_rate'])

# removing outliers using z-score
z=np.abs(stats.zscore(df.crime_rate))

threshold=3
print(np.where(z>3))

df1=df[(z<3)]

np.percentile(df1.	n_hot_rooms,[99])
upperlimit=np.percentile(df1.	n_hot_rooms,[99])[0]
df1[(df1.n_hot_rooms>upperlimit)]
df1.n_hot_rooms[(df1.n_hot_rooms>3*upperlimit)]=3*upperlimit
lv=np.percentile(df1.rainfall,[1])[0]
df1[(df1.rainfall<lv)]
df1.rainfall[(df1.rainfall<3*lv)]=0.3*lv

df1['avg_dist']=(df1.dist1+df1.dist2+df1.dist3+df1.dist4)/4
del df1['dist1']
del df1['dist2']
del df1['dist4']
del df1['dist3']

#creating dummies
df1=pd.get_dummies(df1)
del df1['airport_NO']
del df1['waterbody_None']
del df1['rainfall']
del df1['bus_ter_YES']

sns.pairplot(data=df1[['crime_rate','n_hot_rooms','price','n_hos_beds','air_qual','resid_area']],hue='price',dropna=True,height=3)

X=df1.drop('price',axis=1)
Y=df1['price']

from sklearn.model_selection import train_test_split
X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.2)

from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score
model1=LinearRegression()
model1.fit(X_train,Y_train)
Y_test_a=model1.predict(X_test)
r2_score(Y_test,Y_test_a)

